---
title:    "Bash: 文字列の長さを見つける"
keywords: ["Bash"]
---

{{< edit_this_page >}}

## Why

バッシュプログラムを書く時、文字列の長さを調べる必要があることがよくあります。例えば、入力された文字列が所定の長さよりも長いか短いかを確認したい場合や、文字列の一部を取り出したい場合などが挙げられます。そこで、今回は文字列の長さを調べる方法についてご紹介します。

## How To

まずは、文字列の長さを調べるためにはどのようなコマンドを使えばいいのかを見ていきましょう。Bashプログラムでは、以下のような簡単なコマンドを使うことができます。

```Bash
#!/bin/bash

# 文字列を定義する
str="Hello World"

# 文字列の長さを出力する
echo "文字列の長さは ${#str} です。"
```

この場合、変数strに"Hello World"という文字列が格納されています。そして、${#str}という記述をすることで、この文字列の長さを調べることができます。上記のプログラムを実行すると、`文字列の長さは 11 です。`という出力が得られるはずです。

また、環境変数の一部を参照する場合は、${#VARNAME}という形式で文字列の長さを調べることもできます。例えば、$PATHという環境変数に格納されているパスの長さを調べたい場合は、以下のように記述します。

```Bash
#!/bin/bash

# 環境変数PATHの長さを出力する
echo "PATHの長さは ${#PATH} です。"
```

これで、PATHの長さが調べられるようになります。

## Deep Dive

文字列の長さを調べるためには、変数に格納された文字列のバイト数をカウントすることが主な方法です。ただし、マルチバイト文字や改行文字など特殊文字を含む場合は、一文字につき1バイトとは限りません。そのため、正確な文字列の長さを求めるには、環境変数`LANG`と`LC_ALL`を設定しておくことが重要です。

例えば、日本語を含む文字列の長さを調べる場合は、以下のようにして環境変数を設定してからプログラムを実行することで正確な結果が得られます。

```Bash
#!/bin/bash

# LANGを日本語に設定する
export LANG=ja_JP.UTF-8

# LC_ALLを英語に設定する
export LC_ALL=en_US.UTF-8

# 日本語を含む文字列を定義する
str="こんにちは、世界！"

# 文字列の長さを出力する
echo "${str}の長さは ${#str} です。"
```

このように環境変数を設定することで、マルチバイト文字を正しくカウントして文字列の長さを求めることができます。

## See Also

- [Linuxコマンド入門: 文字列の長さを調べる](https://www.atmarkit.co.jp/ait/articles/1803/02/news029.html)
- [20 シェル・スクリプト言語で文字列の長