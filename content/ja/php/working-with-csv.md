---
title:                "PHP: 「CSVファイルの操作」"
simple_title:         "「CSVファイルの操作」"
programming_language: "PHP"
category:             "PHP"
tag:                  "Data Formats and Serialization"
editURL:              "https://github.com/dogweather/forkful/blob/master/content/ja/php/working-with-csv.md"
---

{{< edit_this_page >}}

##なぜCSVを使うのか

CSVというファイル形式は、大量のデータを手軽に扱うことができるため、プログラミングでよく使用されます。特に、PHPはCSVファイルを簡単に読み書きできるため、データ処理に使うのにとても便利です。

##CSVファイルをPHPで読み書きする方法

まず、CSVファイルを読み込むには、`fopen()`関数を使用します。これにより、ファイルを開いた後、`fgetcsv()`関数を使用してデータを読み取ることができます。以下のPHPコードを見てみましょう。

```php
$file = fopen('data.csv', 'r') //ファイルを読み込む
while (($data = fgetcsv($file)) !== FALSE) { //データを読み取る
  print_r($data); //データを出力
}
fclose($file); //ファイルを閉じる
```

上記のコードでは、`data.csv`という名前のファイルを読み込み、データを出力する処理を行っています。また、CSVファイルには、カンマやタブなどで区切られたデータが含まれているため、`fgetcsv()`関数はデフォルトでカンマを区切り文字として扱います。もしファイル内のデータがタブで区切られている場合は、`fgetcsv()`の第二引数に`"\t"`を指定することで、タブを区切り文字として扱うことができます。

また、CSVファイルを書き込むには、`fopen()`関数の第二引数に`w`モードを指定し、`fputcsv()`関数を使用します。以下のようなPHPコードで、CSVファイルにデータを書き込むことができます。

```php
$file = fopen('data.csv', 'w'); //ファイルを書き込みモードで開く
$data = array('John', 'Doe', 'john@example.com'); //書き込むデータ
fputcsv($file, $data); //データを書き込む
fclose($file); //ファイルを閉じる
```

##CSVファイルをPHPで深堀りする

CSVファイルを扱う際に注意しなければいけない点がいくつかあります。例えば、PHPではデフォルトで文字エンコーディングが`ISO-8859-1`となっていますが、CSVファイルは`UTF-8`で保存されることが多いため、文字化けが起こることがあります。このような場合は、`mb_convert_encoding()`関数を使用して、文字エンコーディングを変換する必要があります。

また、CSVファイルには、ヘッダー行が含まれている場合があります。これは、データの一番上に項目名が書かれている行のことを言います。PHPでは、`fgetcsv()`関数を使用してデータを読み取る際に、第二引数に`0`を指定することで、ヘッダー行を無視することができます。もしデータにヘッダー行が含まれていない場合は、第二引数を省略することができます。

##見出し

もしもCSVファイルのデータをトップにコメントを記入したい場合は