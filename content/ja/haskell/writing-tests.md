---
title:    "Haskell: テストの書き方"
keywords: ["Haskell"]
---

{{< edit_this_page >}}

## なぜテストを書くのか？

プログラミング言語として、Haskellは静的型付けや強力な型システムを備えています。しかし、それでも私たちはバグを作り出してしまいます。テストは、私たちのコードが意図した通りに動くかどうかを確認するための重要な手段です。テストを書くことで、より信頼性の高いコードを作ることができます。

## テストの書き方

テストを書くには、テストフレームワークとしてよく知られるHspecを使用することができます。Hspecを使用すると、テストスイートを簡単に作成することができます。以下のコードを参考にしてください。

```Haskell
-- テストスイートをインポート
import Test.Hspec

-- 同じファイルに実装した関数をインポート
import Lib (add, subtract)

-- describe関数を使ってテストスイートを定義
-- describeの第1引数にはテスト対象の関数やモジュールの名前を指定
describe "add" $ do

  -- it関数を使ってテストケースを定義
  -- itの第1引数にはテストケースの説明を、第2引数には期待する結果を指定
  it "3と5を足した結果は8になるべき" $ do
    add 3 5 `shouldBe` 8

  it "10と(-2)を足した結果は8になるべき" $ do
    add 10 (-2) `shouldBe` 8

describe "subtract" $ do

  it "5から3を引いた結果は2になるべき" $ do
    subtract 5 3 `shouldBe` 2

  it "3から10を引いた結果は(-7)になるべき" $ do
    subtract 3 10 `shouldBe` (-7)


-- テストの実行
-- main関数を実行することで、テストスイートが実行される
main :: IO ()
main = hspec $ describe "テストスイート全体" $ do
  it "add関数のテストを実行" $ do
    hspec (describe "add" $ return ())
  it "subtract関数のテストを実行" $ do
    hspec (describe "subtract" $ return ())
```

上記のコードを実行すると、以下のような結果が表示されるはずです。

```
テストスイート全体
  add関数のテストを実行
    add
      3と5を足した結果は8になるべき
      10と(-2)を足した結果は8になるべき
  subtract関数のテストを実行
    subtract
      5から3を引いた結果は2になるべき
      3から10を引いた結果は(-7)になるべき

Finished in 0.0014 seconds
6 examples, 0 failures
```

これで、テストが正しく書かれているかどうかを簡単に確認することができます。

## テストを書くときのポイント

テストを書く際には、以下のポイントに注意するとより効果的なテストを書くことができます。

- テストケースは可能な限り網羅的に書く。例えば、ユーザーの入力が空の場合や特殊な文字を含む場合など、想定外のケースもテストする。