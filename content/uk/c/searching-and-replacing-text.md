---
title:    "C: Пошук та заміна тексту"
keywords: ["C"]
---

{{< edit_this_page >}}

## Чому

У сфері програмування постійно потрібно змінювати тексти, робити заміни слів або фраз. Це може стати часом витратним та нудним процесом, але існують способи його автоматизації. У цій статті ми розглянемо, як шукати та замінювати текст у програмі C.

## Як

Для початку, розглянемо простий приклад, як виконати заміну тексту у програмі C. Для цього використаємо функцію `strstr()`, яка шукає перше входження підрядка у рядку. Наприклад, ми хочемо замінити усі входження слова "казка" на "іграшка" у рядку `text`.

```C
char *search = "казка";
char *replace = "іграшка";
char *result = strstr(text, search);
```

У даному випадку `result` буде містити початкову адресу першого входження слова "казка" у рядку `text`. Тепер можна використовувати цю адресу для заміни слова на "іграшка".

```C
strcpy(result, replace);
```

Таким чином, ми замінили перше входження "казка" на "іграшка". Але щоб замінити всі входження, необхідно повторювати цей процес до тих пір, поки функція `strstr()` не поверне `NULL`.

```C
while(result != NULL) {
    strcpy(result, replace);
    result = strstr(text, search);
}
```

Тепер, у нас є функція, яка замінює усі входження підрядка у рядку.

## Deep Dive

Щоб детальніше розібратись, як працює функція `strstr()`, потрібно розглянути, як вона шукає входження підрядка. Для цього вона використовує алгоритм Кнута-Морріса-Пратта (КМП). Цей алгоритм дозволяє шукати входження слова у рядку за час O(n), де n - довжина рядка.

КМП алгоритм заснований на побудові так званого префікс-функції, яка визначає максимальну довжину префіксу рядка, який є одночасно його суфіксом. Прикладом префікс-функції для слова "абрр" буде масив [0, 0, 0, 1], оскільки найбільший префікс, який є одночасно суфіксом, має довжину 1.

КМП алгоритм знаходить входження підрядка у рядку, використовуючи префікс-функцію слова. Спочатку вона шукає перший символ підрядка у рядку, а потім перевіряє, ч