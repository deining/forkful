---
title:    "C: Перевірка наявності каталогу"
keywords: ["C"]
---

{{< edit_this_page >}}

## Почему

Програмісти часто стикаються з ситуацією, коли необхідно перевірити, чи існує певна директорія на комп'ютері. Це може бути зроблено з різних причин, наприклад, для перевірки доступу до файлів або для збереження даних в окремий каталог.

## Як це зробити

Почнемо з найпростішого способу перевірки існування директорії в програмі. Для цього ми використовуємо бібліотеку ```<sys/stat.h>```. Дана бібліотека містить функцію ```stat ()```, що дозволяє нам отримати статистичну інформацію про файл або директорію. Для нашої мети ми використовуємо поле ```struct stat st_mode```, яке містить режим директорії. Якщо це поле повертає статичну константу ```S_IFDIR```, це означає, що директорія існує.

Нижче наведено приклад коду на мові C, який перевіряє, чи існує директорія з назвою "my_directory". Якщо директорія існує, виводиться повідомлення "Directory exists!", в іншому випадку - "Directory doesn't exist!".

```c
#include <stdio.h>
#include <sys/stat.h>

int main()
{
    struct stat st;

    // перевірка існування директорії "my_directory"
    if (stat("my_directory", &st) == 0 && st.st_mode & S_IFDIR)
    {
        printf("Directory exists!");
    }
    else
    {
        printf("Directory doesn't exist!");
    }

    return 0;
}
```

### Вихід:

```sh
Directory exists!
```

У випадку, якщо директорія не існує, функція ```stat()``` поверне значення -1, тому ми перевіряємо також, чи поле ```errno``` дорівнює значенню ```ENOENT```, що означає відсутність файлу або директорії. З цими умовами ми може модифікувати нашу програму, як показано нижче:

```c
#include <stdio.h>
#include <sys/stat.h>
#include <errno.h>

int main()
{
    struct stat st;

    // перевірка існування директорії "my_directory"
    if (stat("my_directory", &st) == 0 && st.st_mode & S_IFDIR)
    {
        printf("Directory exists!");
    }
    else if (errno == ENOENT) 
    {
        printf("Directory doesn't exist!");
    }
    else 
    {
        printf("Error: %s", strerror(errno));
    }

    return 0;
}
```

### Вихід:

```sh
Directory exists!
```

## Вдетальніше

Якщо ви більш досвідчений програміст і хочете краще зрозуміти, як саме функція ```stat()``` перевіряє існування директорії, варто заглянути у джерело. Ви может