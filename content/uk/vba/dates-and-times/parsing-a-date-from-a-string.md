---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:58:28.632455-07:00
description: "\u042F\u043A \u0446\u0435 \u0437\u0440\u043E\u0431\u0438\u0442\u0438\
  : VBA \u043F\u0440\u043E\u043F\u043E\u043D\u0443\u0454 \u043F\u0440\u043E\u0441\u0442\
  \u0438\u0439 \u0441\u043F\u043E\u0441\u0456\u0431 \u0440\u043E\u0437\u0431\u043E\
  \u0440\u0443 \u0440\u044F\u0434\u043A\u0430 \u043D\u0430 \u0434\u0430\u0442\u0443\
  \ \u0437\u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E \u0444\u0443\
  \u043D\u043A\u0446\u0456\u0457 `CDate` \u0430\u0431\u043E \u0444\u0443\u043D\u043A\
  \u0446\u0456\u0457 `DateValue`. \u041F\u0440\u043E\u0442\u0435, \u0432\u0430\u0436\
  \u043B\u0438\u0432\u043E, \u0449\u043E\u0431 \u0440\u044F\u0434\u043E\u043A \u0431\
  \u0443\u0432 \u0443\u2026"
lastmod: '2024-03-13T22:44:49.026239-06:00'
model: gpt-4-0125-preview
summary: "VBA \u043F\u0440\u043E\u043F\u043E\u043D\u0443\u0454 \u043F\u0440\u043E\u0441\
  \u0442\u0438\u0439 \u0441\u043F\u043E\u0441\u0456\u0431 \u0440\u043E\u0437\u0431\
  \u043E\u0440\u0443 \u0440\u044F\u0434\u043A\u0430 \u043D\u0430 \u0434\u0430\u0442\
  \u0443 \u0437\u0430 \u0434\u043E\u043F\u043E\u043C\u043E\u0433\u043E\u044E \u0444\
  \u0443\u043D\u043A\u0446\u0456\u0457 `CDate` \u0430\u0431\u043E \u0444\u0443\u043D\
  \u043A\u0446\u0456\u0457 `DateValue`."
title: "\u0420\u043E\u0437\u0431\u0456\u0440 \u0434\u0430\u0442\u0438 \u0437 \u0440\
  \u044F\u0434\u043A\u0430"
weight: 30
---

## Як це зробити:
VBA пропонує простий спосіб розбору рядка на дату за допомогою функції `CDate` або функції `DateValue`. Проте, важливо, щоб рядок був у впізнаваному форматі дати.

Ось простий приклад використання `CDate`:

```basic
Sub ParseDateUsingCDate()
    Dim dateString As String
    Dim parsedDate As Date
    
    dateString = "2023-04-01"
    parsedDate = CDate(dateString)
    
    Debug.Print "Розібрана дата: "; parsedDate
End Sub
```

Якщо ви запустите цей код, вивід у вікні "Терміново" (доступно через `Ctrl+G` у редакторі VBA) буде:

```
Розібрана дата: 4/1/2023 
```

Альтернативно, ви можете використовувати функцію `DateValue`, яка більш конкретна для дат (ігноруючи частину часу):

```basic
Sub ParseDateUsingDateValue()
    Dim dateString As String
    Dim parsedDate As Date
    
    dateString = "1 квітня 2023"
    parsedDate = DateValue(dateString)
    
    Debug.Print "Розібрана дата за допомогою DateValue: "; parsedDate
End Sub
```

Приклад виводу для цього так само покаже в вікні "Терміново":

```
Розібрана дата за допомогою DateValue: 4/1/2023
```

Пам'ятайте, що успіх розбору залежить від відповідності формату дати у рядку налаштуванням системи або додатка.

## Поглиблений аналіз
Внутрішньо, коли VBA розбирає рядок на дату, він використовує регіональні налаштування операційної системи Windows для інтерпретації формату дати. Це важливо розуміти, тому що рядок дати, який ідеально розбирається на одній системі, може викликати помилку на іншій, якщо вони використовують різні налаштування дати/часу.

Історично, обробка дат була поширеним джерелом помилок у додатках, особливо тих, що використовуються міжнародно. Ця залежність від регіональних налаштувань у VBA є причиною, по якій деякі можуть розглядати альтернативи, такі як формат ISO 8601 (наприклад, "RRRR-MM-DD") для недвозначного представлення та розбору дат на різних системах. На жаль, VBA не підтримує ISO 8601 вроджено, і для строгого дотримання була б потрібна ручна обробка.

Для складного розбору дат, який виходить за межі того, що можуть зробити `CDate` або `DateValue`, або для забезпечення послідовного розбору незалежно від налаштувань локалі системи, програмісти можуть вдатися до функцій користувацького розбору. Це може включати розділення рядка дати на компоненти (рік, місяць, день) і створення дати за допомогою функції `DateSerial`. Інші можуть вибрати потужніші мови або бібліотеки, розроблені з урахуванням інтернаціоналізації, для подібних завдань.
