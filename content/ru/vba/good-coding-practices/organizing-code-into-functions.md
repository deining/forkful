---
changelog:
- 2024-02-01, gpt-4-0125-preview, translated from English
date: 2024-02-01 21:56:55.666557-07:00
description: "\u041A\u0430\u043A \u044D\u0442\u043E \u0441\u0434\u0435\u043B\u0430\
  \u0442\u044C: \u0412 VBA \u0444\u0443\u043D\u043A\u0446\u0438\u0438 \u043E\u043F\
  \u0440\u0435\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0441 \u0438\u0441\
  \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435\u043C \u0438\u043D\
  \u0441\u0442\u0440\u0443\u043A\u0446\u0438\u0439 `Function` \u0438 `End Function`.\
  \ \u0412\u043E\u0442 \u043F\u0440\u043E\u0441\u0442\u043E\u0439 \u043F\u0440\u0438\
  \u043C\u0435\u0440 \u0442\u043E\u0433\u043E, \u043A\u0430\u043A \u0441\u043E\u0437\
  \u0434\u0430\u0442\u044C \u0444\u0443\u043D\u043A\u0446\u0438\u044E, \u043A\u043E\
  \u0442\u043E\u0440\u0430\u044F\u2026"
lastmod: '2024-03-13T22:44:44.753000-06:00'
model: gpt-4-0125-preview
summary: "\u0412 VBA \u0444\u0443\u043D\u043A\u0446\u0438\u0438 \u043E\u043F\u0440\
  \u0435\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0441 \u0438\u0441\u043F\
  \u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435\u043C \u0438\u043D\u0441\
  \u0442\u0440\u0443\u043A\u0446\u0438\u0439 `Function` \u0438 `End Function`."
title: "\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F \u043A\u043E\
  \u0434\u0430 \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438"
weight: 18
---

## Как это сделать:
В VBA функции определяются с использованием инструкций `Function` и `End Function`. Вот простой пример того, как создать функцию, которая вычисляет площадь прямоугольника:

```basic
Function CalculateArea(length As Double, width As Double) As Double
    CalculateArea = length * width
End Function
```

Чтобы вызвать эту функцию в вашем коде VBA и отобразить результат в окне сообщений, вы должны использовать:

```basic
Sub ShowArea()
    Dim area As Double
    area = CalculateArea(10, 5)
    MsgBox "Площадь равна " & area
End Sub
```

При выполнении этот код отображает окно сообщений с текстом: `Площадь равна 50`.

### Передача переменных ByRef и ByVal
VBA позволяет передавать переменные в функции либо по ссылке (`ByRef`), либо по значению (`ByVal`). Первое означает, что оригинальная переменная может быть изменена функцией, тогда как второе передает копию, защищая оригинальную переменную от изменений.

```basic
Function ModifyValue(ByRef num As Integer)
    num = num + 5
End Function

Function PreserveValue(ByVal num As Integer) As Integer
    num = num + 5
    PreserveValue = num
End Function
```

## Глубокое погружение
VBA, как язык программирования, ориентированный на события, придает большое значение функциям и подпрограммам для обработки различных задач. В отличие от многих современных языков, VBA имеет уникальную особенность, где ключевое слово `Function` не только объявляет блок повторно используемого кода, но также позволяет неявно возвращать значение непосредственно присвоенное имени функции.

Исторически дизайн функций VBA был под влиянием более ранних парадигм программирования, где инкапсуляция и модульность постепенно признавались за их важность в разработке программного обеспечения. Этот исторический фон привел VBA к принятию несколько консервативного, но функционального подхода к организации кода.

Хотя VBA мощен в своих собственных средах (например, приложениях Microsoft Office), важно отметить, что мир программирования эволюционировал. Языки, такие как Python, предлагают более простой синтаксис и обширную стандартную библиотеку, делая их привлекательной альтернативой для различных приложений за пределами пакета Office. Однако при работе внутри продуктов Microsoft Office возможности интеграции и автоматизации, которые предоставляет VBA, несравнимы.

Стоит отметить, что несмотря на свой возраст, сообщество вокруг VBA остается активным, постоянно находя инновационные способы использования его функциональности. Тем не менее, поскольку индустрия программного обеспечения движется в сторону более современных, многофункциональных и надежных языков, программистам, знакомым с VBA, рекомендуется исследовать эти альтернативы для задач, не связанных с Office, чтобы расширить свой инструментарий кодирования.
